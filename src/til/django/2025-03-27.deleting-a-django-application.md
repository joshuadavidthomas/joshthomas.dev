---
title: Deleting a Django application
---

> [!DOCUMENTATION]
>
> Django provides the ability to group sets of features into Python packages called [applications](https://docs.djangoproject.com/en/5.1/ref/applications/). When requirements change, apps may become obsolete or unnecessary. The following steps will help you delete an application safely.
> 
> 1. Remove all references to the app (imports, foreign keys etc.).
> 2. Remove all models from the corresponding `models.py` file.
> 3. Create relevant migrations by running [`makemigrations`](https://docs.djangoproject.com/en/5.1/ref/django-admin/#django-admin-makemigrations). This step generates a migration that deletes tables for the removed models, and any other required migration for updating relationships connected to those models.
> 4. [Squash](https://docs.djangoproject.com/en/5.1/topics/migrations/#migration-squashing) out references to the app in other apps’ migrations.
> 5. Apply migrations locally, runs tests, and verify the correctness of your project.
> 6. Deploy/release your updated Django project.
> 7. Remove the app from [`INSTALLED_APPS`](https://docs.djangoproject.com/en/5.1/ref/settings/#std-setting-INSTALLED_APPS).
> 8. Finally, remove the app’s directory.
>
> - [How to delete a Django application](https://docs.djangoproject.com/en/5.1/howto/delete-app/)

- What exactly does squash out references mean?

---

1. Delete app folder.
2. App crashes.

   ```bash
   2025-03-27 23:20:55,013 django.utils.autoreload INFO     /app/lease/settings.py changed, reloading.
   2025-03-27 23:20:59,153 django.utils.autoreload INFO     Watching for file changes with StatReloader
   Exception in thread django-main-thread:
   Traceback (most recent call last):
     File "/usr/local/lib/python3.12/threading.py", line 1075, in _bootstrap_inner
       self.run()
     File "/usr/local/lib/python3.12/threading.py", line 1012, in run
       self._target(*self._args, **self._kwargs)
     File "/usr/local/lib/python3.12/site-packages/django/utils/autoreload.py", line 64, in wrapper
       fn(*args, **kwargs)
     File "/usr/local/lib/python3.12/site-packages/django/core/management/commands/runserver.py", line 137, in inner_run
       self.check_migrations()
     File "/usr/local/lib/python3.12/site-packages/django/core/management/base.py", line 581, in check_migrations
       executor = MigrationExecutor(connections[DEFAULT_DB_ALIAS])
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     File "/usr/local/lib/python3.12/site-packages/django/db/migrations/executor.py", line 18, in __init__
       self.loader = MigrationLoader(self.connection)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     File "/usr/local/lib/python3.12/site-packages/django/db/migrations/loader.py", line 58, in __init__
       self.build_graph()
     File "/usr/local/lib/python3.12/site-packages/django/db/migrations/loader.py", line 276, in build_graph
       self.graph.validate_consistency()
     File "/usr/local/lib/python3.12/site-packages/django/db/migrations/graph.py", line 198, in validate_consistency
       [n.raise_error() for n in self.node_map.values() if isinstance(n, DummyNode)]
        ^^^^^^^^^^^^^^^
     File "/usr/local/lib/python3.12/site-packages/django/db/migrations/graph.py", line 60, in raise_error
       raise NodeNotFoundError(self.error_message, self.key, origin=self.origin)
   django.db.migrations.exceptions.NodeNotFoundError: Migration tracts.0001_initial dependencies reference nonexistent parent node ('mgmtunits', '0001_initial')
   ```

3. Find all mentions of old app

   ```bash
   ➜ fd migrations -t d -x rg mgmtunits
   ./lease/tracts/migrations/0001_initial.py:        ("mgmtunits", "0001_initial"),
   ./lease/tracts/migrations/0001_initial.py:                        to="mgmtunits.managementunit",
   ```

4. Used just in the first migration, list the files

```bash
➜ la lease/tracts/migrations
Permissions Size User Date Modified Name
.rw-r--r--@  17k josh  9 Oct  2024  0001_initial.py
.rw-r--r--@  855 josh  9 Oct  2024  0002_remove_tract_lease_tract_search__416713_gin_and_more.py
.rw-r--r--@  461 josh  9 Oct  2024  0003_tract_lease_tract_status_47809e_idx.py
.rw-r--r--@  420 josh  9 Oct  2024  0004_tract_status_changed.py
.rw-r--r--@ 1.1k josh  9 Oct  2024  0005_alter_tract_aerial_map_alter_tract_boundary_map_and_more.py
.rw-r--r--@ 2.0k josh  9 Oct  2024  0006_remove_tract_date_originally_created_and_more.py
.rw-r--r--@ 2.8k josh  9 Oct  2024  0007_remove_tract_created_remove_tract_modified_and_more.py
.rw-r--r--@  592 josh 18 Feb 23:25  0008_insurancerate_tract_customer.py
.rw-r--r--@  344 josh 27 Mar 08:42  0009_remove_tract_status_changed.py
.rw-r--r--@  719 josh 27 Mar 08:42  0010_remove_insurancerate_lease_insur_legacy__101810_idx_and_more.py
.rw-r--r--@  719 josh 27 Mar 15:21  0011_alter_tract_management_unit.py
.rw-r--r--@    0 josh  9 Oct  2024  __init__.py
drwxr-xr-x@    - josh 27 Mar 23:12  __pycache__/
```

5. Look at squash link https://docs.djangoproject.com/en/5.1/topics/migrations/#migration-squashing

```bash
$ ./manage.py squashmigrations myapp 0004
Will squash the following migrations:
 - 0001_initial
 - 0002_some_change
 - 0003_another_change
 - 0004_undo_something
Do you wish to proceed? [y/N] y
Optimizing...
  Optimized from 12 operations to 7 operations.
Created new squashed migration /home/andrew/Programs/DjangoTest/test/migrations/0001_squashed_0004_undo_something.py
  You should commit this migration but leave the old ones in place;
  the new migration will be used for new installs. Once you are sure
  all instances of the codebase have applied the migrations you squashed,
  you can delete them.
```

6. squash to 0002, error

```bash
django.db.migrations.exceptions.NodeNotFoundError: Migration tracts.0001_initial dependencies reference nonexistent parent node ('mgmtunits', '0001_initial')
```

7. Undo deletion of app directory, try again

```bash
➜ just manage squashmigrations tracts 0002
docker compose run --rm  app /bin/bash -c 'python -m manage squashmigrations tracts 0002'
[+] Creating 2/2
 ✔ Container lease-node-1  Running                                                                   0.0s
 ✔ Container lease-db-1    Running                                                                   0.0s
System check identified some issues:

WARNINGS:
ChargeType: (ordered_model.W003) OrderedModelBase subclass has a ModelManager that does not inherit from OrderedModelManager. This is not ideal but will work.
Will squash the following migrations:
 - 0001_initial
 - 0002_remove_tract_lease_tract_search__416713_gin_and_more
Do you wish to proceed? [y/N] y
Optimizing...
  Optimized from 11 operations to 8 operations.
Created new squashed migration /app/lease/tracts/migrations/0001_squashed_0002_remove_tract_lease_tract_search__416713_gin_and_more.py
  You should commit this migration but leave the old ones in place;
  the new migration will be used for new installs. Once you are sure
  all instances of the codebase have applied the migrations you squashed,
  you can delete them.
```

8. search again, app still in squashed migration

```bash
lease/tracts/migrations/0001_initial.py
17:        ("mgmtunits", "0001_initial"),
327:                        to="mgmtunits.managementunit",

lease/tracts/migrations/0001_squashed_0002_remove_tract_lease_tract_search__416713_gin_and_more.py
20:        ('mgmtunits', '0001_initial'),
89:                ('management_unit', models.ForeignKey(help_text='The management unit this tract is associated with. FK to lease.ManagementUnit', on_delete=django.db.models.deletion.PROTECT, related_name='tracts', to='mgmtunits.managementunit')),
```

9. Clean and setup app again, see squashed migration run instead of original, start app

```bash
  Applying customers.0001_initial... OK
  Applying mgmtunits.0001_initial... OK
  Applying clubs.0001_initial... OK
  Applying managers.0001_initial... OK
  Applying tracts.0001_squashed_0002_remove_tract_lease_tract_search__416713_gin_and_more... OK
  Applying leases.0001_initial... OK
```

10. remove from `INSTALLED_APPS`, still see error
11. delete squashed migration
12. copy two app createmodels from new app migrations separatedatabasemodelandstate, add to new app's initial migration
13. remove from `INSTALLED_APPS`, clean and setup again
