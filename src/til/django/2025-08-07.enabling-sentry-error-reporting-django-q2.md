---
title: Enabling Sentry error reporting in Django Q2
---

At work, we've settled on the library Django Q2 for all of our async tasks needs: sending emails, the occasional cron processing job, etc. It'

> [!NOTE]
> In ~5 years of professionally developing with Django, I've managed to somehow avoid using Celery.

- simple to setup and use with the ORM database queue, no separate Redis/RabbitMQ/etc to run

```python
import sentry_sdk
from environs import env


env.read_env()

if SENTRY_DSN := env.str("SENTRY_DSN", default=None, validate=validate.URL()):
    sentry_sdk.init(
        dsn=SENTRY_DSN,
        environment=env.str(
            "SENTRY_ENV",
            default="development",
            validate=validate.OneOf(["development", "test", "staging", "production"]),
        ),
        integrations=[
            DjangoIntegration(),
            LoggingIntegration(),
        ],
        profile_lifecycle="trace",
        profile_session_sample_rate=1.0,
        send_default_pii=True,
        traces_sample_rate=1.0,
    )
```

```python
import sentry_sdk


sentry_sdk.init(
    dsn=SENTRY_DSN,
    # ...
)

# enable django-q2 error reporter
Q_CLUSTER["error_reporter"] = {
    "sentry": {
        "dsn": SENTRY_DSN,
    }
}
```

```python
import sentry_sdk


def patch_django_q_sentry():
    import django_q_sentry.sentry

    OriginalSentry = django_q_sentry.sentry.Sentry

    class PatchedSentry(OriginalSentry):
        def __init__(self, dsn, **kwargs):
            if not sentry_sdk.is_initialized():
                super().__init__(dsn, **kwargs)

    django_q_sentry.sentry.Sentry = PatchedSentry


sentry_sdk.init(
    dsn=SENTRY_DSN,
    # ...
)

patch_django_q_sentry()

# enable django-q2 error reporter
Q_CLUSTER["error_reporter"] = {
    "sentry": {
        "dsn": SENTRY_DSN,
    }
}
```

```python
import sentry_sdk
from environs import env


def patch_django_q_sentry():
    import django_q_sentry.sentry

    OriginalSentry = django_q_sentry.sentry.Sentry

    class PatchedSentry(OriginalSentry):
        def __init__(self, dsn, **kwargs):
            if not sentry_sdk.is_initialized():
                super().__init__(dsn, **kwargs)

    django_q_sentry.sentry.Sentry = PatchedSentry


env.read_env()

if SENTRY_DSN := env.str("SENTRY_DSN", default=None, validate=validate.URL()):
    sentry_sdk.init(
        dsn=SENTRY_DSN,
        environment=env.str(
            "SENTRY_ENV",
            default="development",
            validate=validate.OneOf(["development", "test", "staging", "production"]),
        ),
        integrations=[
            DjangoIntegration(),
            LoggingIntegration(),
        ],
        profile_lifecycle="trace",
        profile_session_sample_rate=1.0,
        send_default_pii=True,
        traces_sample_rate=1.0,
    )

    patch_django_q_sentry()

    # enable django-q2 error reporter
    Q_CLUSTER["error_reporter"] = {
        "sentry": {
            "dsn": SENTRY_DSN,
        }
    }
```
